"0","# check for multilevel structure"
"0","# null multilevel model"
"0","fit_null_multi <- glmer(Coverage ~ (1 | CCG16CD),"
"0","               family=binomial, weights=Eligible,"
"0","               data=coverage_data_supplemented2)"
"0","# null  single level model"
"0","fit_null_single <- glm(Coverage ~ 1,"
"0","               family=binomial, weights=Eligible,"
"0","               data=coverage_data_supplemented2)"
"0","# compare AIC"
"0","bbmle::AICtab(fit_null_single, fit_null_multi)"
"1","               "
"1"," dAIC    "
"1"," df"
"1","
fit_null_multi "
"1","      0.0"
"1"," 2 "
"1","
fit_null_single"
"1"," 123326.7"
"1"," 1 "
"1","
"
"0","AIC(fit_null_single, fit_null_multi)"
"1","               "
"1"," df"
"1","      AIC"
"1","
fit_null_single"
"1","  1"
"1"," 338896.9"
"1","
fit_null_multi "
"1","  2"
"1"," 215570.3"
"1","
"
"0","# Likelihood Ratio Testing"
"0","# create function to perform likelihood ratio test"
"0","# https://stat.ethz.ch/pipermail/r-sig-mixed-models/2008q3/001175.html"
"0","lrt <- function (obj1, obj2) {"
"0","    L0 <- logLik(obj1)"
"0","    L1 <- logLik(obj2)"
"0","    L01 <- as.vector(- 2 * (L0 - L1))"
"0","    df <- attr(L1, ""df"") - attr(L0, ""df"")"
"0","    list(L01 = L01, df = df,"
"0","        ""p-value"" = pchisq(L01, df, lower.tail = FALSE))"
"0"," }"
"0","# perform a likelihood ratio test"
"0","lrt(fit_null_single,fit_null_multi)"
"1","$`L01`
"
"1","[1]"
"1"," 123328.7"
"1","
"
"1","
"
"1","$df
"
"1","[1]"
"1"," 1"
"1","
"
"1","
"
"1","$`p-value`
"
"1","[1]"
"1"," 0"
"1","
"
"1","
"
"0","# note that ANOVA gives identical results"
"0","anova(fit_null_multi, fit_null_single)"
"1","Data: coverage_data_supplemented2"
"1","
"
"1","Models:"
"1","
"
"1","fit_null_single: Coverage ~ 1"
"1","
"
"1","fit_null_multi: Coverage ~ (1 | CCG16CD)"
"1","
"
"1","               "
"1"," Df"
"1","    AIC"
"1","    BIC"
"1","  logLik"
"1"," deviance"
"1","  Chisq"
"1"," Chi Df"
"1"," Pr(>Chisq)"
"1","    "
"1","
fit_null_single"
"1","  1"
"1"," 338897"
"1"," 338904"
"1"," -169447"
"1","   338895"
"1","       "
"1","       "
"1","           "
"1","    "
"1","
fit_null_multi "
"1","  2"
"1"," 215570"
"1"," 215584"
"1"," -107783"
"1","   215566"
"1"," 123329"
"1","      1"
"1","  < 2.2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
